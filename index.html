<!DOCTYPE html>
<html lang="pt-br">
<head>
Â  <meta charset="UTF-8">
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <title>Nosso Cantinho ğŸ’•</title>
Â  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;700&family=Quicksand:wght@400;600&display=swap" rel="stylesheet">
Â Â 
Â  <style>
Â  Â  body {
Â  Â  Â  font-family: "Quicksand", sans-serif;
Â  Â  Â  background: linear-gradient(to bottom right, #8e1e5c, #d86ca3);
Â  Â  Â  margin: 0;
Â  Â  Â  color: #fff;
Â  Â  Â  text-align: center;
Â  Â  Â  min-height: 100vh;
Â  Â  Â  overflow-x: hidden;
Â  Â  Â  background-size: cover;
Â  Â  Â  background-position: center;
Â  Â  Â  background-attachment: fixed;
Â  Â  }

Â  Â  #intro-screen {
Â  Â  Â  position: fixed;
Â  Â  Â  top: 0;
Â  Â  Â  left: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  background: linear-gradient(to bottom right, #8e1e5c, #d86ca3);
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  justify-content: center;
Â  Â  Â  align-items: center;
Â  Â  Â  z-index: 100;
Â  Â  Â  transition: opacity 1s ease;
Â  Â  Â  text-align: center;
Â  Â  Â  padding: 0 20px;
Â  Â  Â  background-size: cover;
Â  Â  Â  background-position: center;
Â  Â  Â  background-attachment: fixed;
Â  Â  }
Â  Â  #intro-screen.fade-out { opacity: 0; pointer-events: none; }

Â  Â  .intro-quote {
Â  Â  Â  max-width: 600px;
Â  Â  Â  font-size: 1.2em;
Â  Â  Â  font-style: italic;
Â  Â  Â  color: #ffeef6;
Â  Â  Â  margin-top: 20px;
Â  Â  Â  animation: fadeInUp 3s ease;
Â  Â  Â  opacity: 0.9;
Â  Â  }

Â  Â  .intro-buttons {
Â  Â  Â  margin-top: 40px;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 15px;
Â  Â  }
Â  Â  #musicBtn, #enterBtn {
Â  Â  Â  background: #ff5c8d;
Â  Â  Â  border: none;
Â  Â  Â  padding: 12px 25px;
Â  Â  Â  border-radius: 8px;
Â  Â  Â  color: #fff;
Â  Â  Â  font-weight: bold;
Â  Â  Â  font-size: 1em;
Â  Â  Â  cursor: pointer;
Â  Â  Â  transition: background 0.3s;
Â  	}
Â  	#musicBtn:hover, #enterBtn:hover { background: #e64c7c; }

Â  	.heart {
Â  	  position: relative;
Â  	  width: 100px;
Â  	  height: 90px;
Â  	  background: #ff5c8d;
Â  	  transform: rotate(-45deg);
Â  	  animation: pulse 1.2s infinite;
Â  	}
Â  	.heart::before, .heart::after {
Â  	  content: "";
Â  	  position: absolute;
Â  	  width: 100px;
Â  	  height: 90px;
Â  	  background: #ff5c8d;
Â  	  border-radius: 50%;
Â  	}
Â  	.heart::before { top: -50px; left: 0; }
Â  	.heart::after { left: 50px; top: 0; }
Â  	@keyframes pulse {
Â  	  0%, 100% { transform: scale(1) rotate(-45deg); }
Â  	  50% { transform: scale(1.1) rotate(-45deg); }
Â  	}

Â  	header {
Â  	  background: rgba(255, 255, 255, 0.1);
Â  	  padding: 25px;
Â  	  box-shadow: 0 0 15px rgba(255, 182, 193, 0.5);
Â  	}
Â  	h1 {
Â  	  font-family: "Dancing Script", cursive;
Â  	  font-size: 2.8em;
Â  	  color: #fff;
Â  	}
Â  	#editBtn {
Â  	  background: #ff5c8d;
Â  	  border: none;
Â  	  padding: 10px 20px;
Â  	  border-radius: 8px;
Â  	  cursor: pointer;
Â  	  color: #fff;
Â  	  font-weight: bold;
Â  	}
Â  	#editBtn:hover { background: #e64c7c; }

Â  	#gallery {
Â  	  display: grid;
Â  	  grid-template-columns: repeat(2, 1fr);
Â  	  gap: 15px;Â 
Â  	  width: 90%;Â 
Â  	  max-width: 900px;Â 
Â  	  margin: 20px auto;Â 
Â  	  padding: 10px;
Â  	  box-sizing: border-box;
Â  	  min-height: 50vh;
Â  	}

Â  	.photo {
Â  	  position: relative;Â 
Â  	  width: 100%;
Â  	  opacity: 1;
Â  	  display: block;
Â  	  aspect-ratio: 1 / 1;Â 
Â  	  border-radius: 10px;Â 
Â  	  overflow: hidden;Â 
Â  	  box-shadow: 0 2px 5px rgba(0,0,0,0.2);
Â  	}
Â  	.photo img {
Â  	  width: 100%;
Â  	  height: 100%;
Â  	  object-fit: cover;Â 
Â  	  display: block;
Â  	  cursor: pointer;
Â  	}
Â  	.caption {
Â  	  position: absolute;
Â  	  bottom: 0;
Â  	  left: 0;
Â  	  width: 100%;
Â  	  text-align: center;
Â  	  font-size: 1em;
Â  	  color: #fff;
Â  	  background: rgba(0,0,0,0.6);
Â  	  padding: 5px;
Â  	  box-sizing: border-box;
Â  	}

Â  	.navigation-buttons {
Â  	  display: none;
Â  	}

Â  	.delete-btn {
Â  	  position: absolute;
Â  	  top: 10px;
Â  	  right: 10px;
Â  	  background: #ff3b3b;
Â  	  color: white;
Â  	  border: none;
Â  	  border-radius: 50%;
Â  	  width: 30px;
Â  	  height: 30px;
Â  	  font-size: 1.2em;
Â  	  font-weight: bold;
Â  	  cursor: pointer;
Â  	  z-index: 10;
Â  	  display: none;Â 
Â  	}

Â  	#main-content.edit-mode-active .delete-btn {
Â  	  display: block;
Â  	}

Â  	#editor {
Â  	  background: rgba(255, 255, 255, 0.15);
Â  	  padding: 20px;
Â  	  margin: 20px auto;
Â  	  width: 90%;
Â  	  max-width: 400px;
Â  	  border-radius: 12px;
Â  	  box-shadow: 0 0 8px rgba(255,255,255,0.3);
Â  	}
Â  	#editor input, #editor button {
Â  	  margin-top: 10px;
Â  	  padding: 10px;
Â  	  width: 80%;
Â  	  border-radius: 8px;
Â  	  border: none;
Â  	  font-size: 1em;
Â  	}
Â  	#addPhoto {
Â  	  background: #ff5c8d;
Â  	  border: none;
Â  	  padding: 10px 20px;
Â  	  border-radius: 8px;
Â  	  cursor: pointer;
Â  	  color: #fff;
Â  	  font-weight: bold;
Â  	}
Â  	#addPhoto:hover { background: #e64c7c; }

Â  	footer {
Â  	  margin-top: 40px;
Â  	  font-size: 0.9em;
Â  	  opacity: 0.8;
Â  	}
Â  	.hidden { display: none; }

Â  	@keyframes fadeInUp {
Â  	  from { opacity: 0; transform: translateY(20px); }
Â  	  to { opacity: 1; transform: translateY(0); }
Â  	}

Â  	#lightbox {
Â  	  position: fixed;
Â  	  top: 0;
Â  	  left: 0;
Â  	  width: 100%;
Â  	  height: 100%;
Â  	  background: rgba(0, 0, 0, 0.8);
Â  	  display: flex;
Â  	  justify-content: center;
Â  	  align-items: center;
Â  	  z-index: 1000;Â 
Â  	  opacity: 0;
Â  	  pointer-events: none;
Â  	  transition: opacity 0.3s ease;
Â  	}

Â  	#lightbox.visible {
Â  	  opacity: 1;
Â  	  pointer-events: all;
Â  	}

Â  	.lightbox-content {
Â  	  position: relative;
Â  	  background: #fff;
Â  	  padding: 20px;
Â  	  border-radius: 15px;
Â  	  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.5);
Â  	  max-width: 90%;
Â  	  max-height: 90%;
Â  	  overflow: hidden;
Â  	  display: flex;
Â  	  flex-direction: column;
Â  	  align-items: center;
Â  	}

Â  	#lightbox-img {
Â  	  max-width: 100%;
Â  	  max-height: 80vh;Â 
Â  	  display: block;
Â  	  object-fit: contain;
Â  	  border-radius: 10px;
Â  	}

Â  	#lightbox-caption {
Â  	  margin-top: 15px;
Â  	  font-size: 1.1em;
Â  	  color: #333;
Â  	  text-align: center;
Â  	  max-width: 100%;
Â  	  word-wrap: break-word;Â 
Â  	}

Â  	.close-lightbox {
Â  	  position: absolute;
Â  	  top: 10px;
Â  	  right: 20px;
Â  	  color: #555;
Â  	  font-size: 30px;
Â  	  font-weight: bold;
Â  	  cursor: pointer;
Â  	  z-index: 1001;
Â  	}

Â  	.close-lightbox:hover {
Â  	  color: #ff3b3b;
Â  	}

Â  	@media (max-width: 600px) {
Â  	  #gallery {
Â  	    grid-template-columns: repeat(1, 1fr);Â 
Â  	  }
Â  	  .photo {
Â  	    aspect-ratio: auto;Â 
Â  	  }
Â  	}

Â  	.caption .music-link-icon {
Â  	  text-decoration: none;
Â  	  font-size: 1.1em;
Â  	  margin-left: 5px;
Â  	  cursor: pointer;Â 
Â  	}

Â  	.caption .music-link-icon:hover {
Â  	  opacity: 0.7;
Â  	}

Â  	.lightbox-music-link {
Â  	  display: block;
Â  	  margin-top: 10px;
Â  	  padding: 8px 12px;
Â  	  background-color: #f0f0f0;
Â  	  border-radius: 8px;
Â  	  color: #8e1e5c;
Â  	  font-weight: bold;
Â  	  text-decoration: none;
Â  	  transition: background-color 0.3s;
Â  	}

Â  	.lightbox-music-link:hover {
Â  	  background-color: #e0e0e0;
Â  	  text-decoration: none;
Â  	}

Â  	#pagination-controls {
Â  	  margin: 20px 0;
Â  	  text-align: center;
Â  	}
Â  	.page-btn, .nav-btn {
Â  	  background: #ff5c8d;
Â  	  border: none;
Â  	  padding: 8px 14px;
Â  	  border-radius: 8px;
Â  	  color: #fff;
Â  	  font-weight: bold;
Â  	  font-size: 1em;
Â  	  cursor: pointer;
Â  	  transition: background 0.3s;
Â  	  margin: 0 4px;
Â  	}
Â  	.page-btn:hover, .nav-btn:hover {
Â  	  background: #e64c7c;
Â  	}
Â  	.page-btn.active {
Â  	  background: #b33c6a;
Â  	  cursor: default;
Â  	}
Â  	.nav-btn:disabled {
Â  	  background: #aaa;
Â  	  cursor: not-allowed;
Â  	}

Â  	.lightbox-nav {
Â  	  position: absolute;
Â  	  top: 50%;
Â  	  transform: translateY(-50%);
Ind Â  background: rgba(255, 255, 255, 0.3);
Â  	  border: none;
Â  	  border-radius: 50%;
Â  	  width: 40px;
Â  	  height: 40px;
Â  	  font-size: 1.5em;
Â  	  color: white;
Â  	  cursor: pointer;
Â  	  transition: background 0.3s;
Â  	  z-index: 1002;
Â  	}
Â  	.lightbox-nav:hover {
Â  	  background: rgba(255, 255, 255, 0.6);
Â  	}
Â  	.lightbox-nav:disabled {
Â  	  background: rgba(255, 255, 255, 0.1);
Â  	  color: #999;
Â  	  cursor: not-allowed;
Â  	}
Â  	#lightbox-prev {
Â  	  left: 30px;
Â  	}
Â  	#lightbox-next {
Â  	  right: 30px;
Â  	}

Â  	#spotify-player {
Â  	  position: fixed;
Â  	  bottom: 15px;
Â  	  right: 15px;
Â  	  border-radius: 12px;
Â  	  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
Â  	  z-index: 999;
Â  	  cursor: move;
Â  	}
Â  	#spotify-status {
Â  	  margin-top: 10px;
Â  	  font-size: 0.95rem;
Â  	  color: #444;
Â  	}
Â  </style>
</head>
<body>
Â Â 
Â  <div id="intro-screen">
Â  	<div class="heart"></div>
Â  	<h1>Bem-vindo(a) ao Nosso Cantinho ğŸ’–</h1>
Â  	<p class="intro-quote">
Â  	  "VocÃª transforma tudo Ã  minha volta em um mundo colorido, obrigada por acender a luz."
Â  	</p>
Â  	<div class="intro-buttons">
Â  	  <button id="enterBtn">Entrar</button>
Â  	</div>
Â  </div>

Â  <div id="main-content" class="hidden">
Â  	<header>
Â  	  <h1>Nosso Cantinho ğŸ’•</h1>
Â  	  <button id="editBtn">Modo EdiÃ§Ã£o</button>
Â  	</header>

Â  	<main id="gallery">
Â  	  <div class="navigation-buttons">
Â  	    <button id="prevBtn">â†</button>
Â  	    <button id="nextBtn">â†’</button>
Â  	  </div>
Â  	</main>

Â  	<div id="pagination-controls"></div>

Â  	<footer>
Â  	  <p>Feito com ğŸ’—. Sou inteiramente sua.</p>
Â  	</footer>

Â  	<div id="editor" class="hidden">
Â  	  <h2>Adicionar nova lembranÃ§a</h2>
Â  	  <input type="file" id="imageInput" accept="image/*">
Â  	  <input type="text" id="captionInput" placeholder="Legenda da foto">
Â  	  <input type="text" id="musicLinkInput" placeholder="Link da mÃºsica (opcional)">
Â  	  <button id="addPhoto">Adicionar</button>

Â  	  <hr style="border-color: rgba(255,255,255,0.2); margin: 20px 0;">
Â  	  <h2>Alterar Fundo da PÃ¡gina</h2>
Â  	  <input type="file" id="bgImageInput" accept="image/*">
Â  	  <button id="changeBgBtn">Salvar Fundo</button>
Â  	  <button id="removeBgBtn" style="background-color: #ff3b3b; margin-top: 5px;">Remover Fundo</button>
Â  	</div>
Â  </div>

Â  <iframe 
Â  	id="spotify-player"
Â  	style="border-radius:12px"
Â  	src="https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator" 
Â  	width="250" 
Â  	height="80" 
Â  	frameBorder="0" 
Â  	allowfullscreen="" 
Â  	allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" 
Â  	loading="lazy">
Â  </iframe>

Â  <div id="lightbox" class="hidden">
Â  	<div class="lightbox-content">
Â  	  <span class="close-lightbox">Ã—</span>
Â  	  
Â  	  <button id="lightbox-prev" class="lightbox-nav">â†</button>
Â  	  <img id="lightbox-img" src="" alt="Foto Ampliada">
Â  	  <button id="lightbox-next" class="lightbox-nav">â†’</button>
Â  	  
Â  	  <div id="lightbox-caption"></div>
Â  	</div>
Â  </div>

Â  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
Â  <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

Â  <script>
Â  	const firebaseConfig = {
Â  	  apiKey: "AIzaSyBnx2V3kPc9U94qJoEsV-eIaoAChR7ety0",
Â  	  authDomain: "inteiramene-sua.firebaseapp.com",
Â  	  databaseURL: "https://inteiramene-sua-default-rtdb.firebaseio.com",
Â  	  projectId: "inteiramene-sua",
Â  	  storageBucket: "inteiramene-sua.firebasestorage.app",
Â  	  messagingSenderId: "801226819273",
Â  	  appId: "1:801226819273:web:107cc21e7e687a1d7a2f18",
Â  	  measurementId: "G-HTCHMNYKTF"
Â  	};

Â  	firebase.initializeApp(firebaseConfig);

Â  	const db = firebase.firestore();
Â  	const photosCollection = db.collection("photos");
Â  	const settingsDoc = db.collection("settings").doc("appSettings");
Â  </script>

Â  <script>
Â  	const gallery = document.getElementById('gallery');
Â  	const editor = document.getElementById('editor');
Â  	const editBtn = document.getElementById('editBtn');
Â  	const addPhotoBtn = document.getElementById('addPhoto');
Â  	const introScreen = document.getElementById('intro-screen');
Â  	const enterBtn = document.getElementById('enterBtn');
Â  	const mainContent = document.getElementById('main-content');
Â  	const spotifyPlayer = document.getElementById('spotify-player');

Â  	const lightbox = document.getElementById('lightbox');
Â  	const lightboxImg = document.getElementById('lightbox-img');
Â  	const lightboxCaption = document.getElementById('lightbox-caption');
Â  	const closeLightboxBtn = document.querySelector('.close-lightbox');

Â  	const musicLinkInput = document.getElementById('musicLinkInput');

Â  	const bgImageInput = document.getElementById('bgImageInput');
Â  	const changeBgBtn = document.getElementById('changeBgBtn');
Â  	const removeBgBtn = document.getElementById('removeBgBtn');

Â  	const paginationControls = document.getElementById('pagination-controls');

Â  	const lightboxPrevBtn = document.getElementById('lightbox-prev');
Â  	const lightboxNextBtn = document.getElementById('lightbox-next');

Â  	let photos = [];
Â  	let currentPage = 1;
Â  	const photosPerPage = 4;
Â  	let currentLightboxIndex = 0;Â 

Â  	const CLOUD_NAME = "doplrv465";
Â  	const UPLOAD_PRESET = "meudengo";

Â  	const bgGradient = "linear-gradient(to bottom right, rgba(142, 30, 92, 0.8), rgba(216, 108, 163, 0.8))";
Â  	const bgGradientSolid = "linear-gradient(to bottom right, #8e1e5c, #d86ca3)";

Â  	function applyBackground(imageUrl) {
Â  	  const bgValue = imageUrl ? `${bgGradient}, url(${imageUrl})` : bgGradientSolid;

Â  	  document.body.style.background = bgValue;
Â  	  introScreen.style.background = bgValue;
Â  	  
Â  	  const styles = {
Â  	    backgroundSize: 'cover',
Â  	    backgroundPosition: 'center',
Â  	    backgroundAttachment: 'fixed'
Â  	  };
Â  	  
Â  	  Object.assign(document.body.style, styles);
Â  	  Object.assign(introScreen.style, styles);
Â  	}

Â  	async function loadSettings() {
Â  	  try {
Â  	    const doc = await settingsDoc.get();
Â  	    if (doc.exists && doc.data().backgroundImageUrl) {
Â  	      applyBackground(doc.data().backgroundImageUrl);
Â  	    } else {
Â  	      removeBackground();Â 
Â  	    }
Â  	  } catch (error) {
Â  	    console.error("Erro ao carregar configuraÃ§Ãµes:", error);
Â  	    removeBackground();
Â  	  }
Â  	}

Â  	async function removeBackground() {
Â  	  applyBackground(null);
Â  	  
Â  	  try {
Â  	    await settingsDoc.set({ backgroundImageUrl: null }, { merge: true });
Â  	    alert("Fundo removido com sucesso!");
Â  	  } catch (error) {
Â  	    console.error("Erro ao remover fundo:", error);
Â  	    alert("Erro ao remover fundo do Firebase.");
Â  	  }
Â  	}

Â  	async function loadPhotos() {
Â  	  try {
Â  	    const snapshot = await photosCollection.orderBy('timestamp', 'desc').get();
Â  	    
Â  	    photos = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));

Â  	    renderGalleryAndPagination();Â 
Â  	  } catch (error) {
Â  	    console.error("Erro ao carregar fotos:", error);
Â  	    alert("Erro ao carregar fotos da nuvem.");
Â  	  }
Â  	}

Â  	async function deletePhoto(photoId) {
Â  	  try {
Â  	    await photosCollection.doc(photoId).delete();
Â  	    await loadPhotos();Â 
Â  	  } catch (error) {
Â  	    console.error("Erro ao deletar foto:", error);
Â  	    alert("Erro ao deletar foto da nuvem.");
Â  	  }
	}

Â  	function renderGalleryAndPagination() {
Â  	  gallery.innerHTML = '';
Â  	  paginationControls.innerHTML = '';

Â  	  const totalPages = Math.ceil(photos.length / photosPerPage);

Â  	  if (currentPage > totalPages) {
Â  	    currentPage = totalPages;
Â  	  }
Â  	  if (currentPage < 1) {
Â  	    currentPage = 1;
Â  	  }

Â  	  const startIndex = (currentPage - 1) * photosPerPage;
Â  	  const endIndex = startIndex + photosPerPage;
Â  	  const photosToShow = photos.slice(startIndex, endIndex);

Â  	  photosToShow.forEach(photo => {
Â  	    const originalIndex = photos.findIndex(p => p.id === photo.id);
Â  	    const div = document.createElement('div');
Â  	    div.className = 'photo';
Â  	    
Â  	    const musicIconHTML = photo.musicLinkÂ 
Â  	      ? `<a href="${photo.musicLink}" target="_blank" class="music-link-icon">ğŸµ</a>`Â 
Â  	      : '';

Â  	    div.innerHTML = `
Â  	      <button class="delete-btn" data-id="${photo.id}">Ã—</button>
Â  	      <img src="${photo.url}" alt="${photo.caption}" data-id="${photo.id}" data-index-in-page="${originalIndex}">
Â  	      <div class="caption">${photo.caption} ${musicIconHTML}</div>`;
Â  	    
Â  	    gallery.appendChild(div);
Â  	  });

Â  	  setupPagination(totalPages);
Â  	  setupLightboxListeners();
Â  	}

Â  	function showLightboxPhoto(index) {
Â  	  currentLightboxIndex = index;
Â  	  const photo = photos[index];

Â  	  if (!photo) return;

Â  	  lightboxImg.src = photo.url;
Â  	  lightboxCaption.innerHTML = `<div>${photo.caption}</div>`;Â 

Â  	  if (photo.musicLink) {
Â  	    lightboxCaption.innerHTML += `<a href="${photo.musicLink}" target="_blank" class="lightbox-music-link">Ouvir mÃºsica ğŸµ</a>`;
Â  	  }
Â  	  
Â  	  lightboxPrevBtn.disabled = (index === 0);
Â  	  lightboxNextBtn.disabled = (index === photos.length - 1);
Â  	}

Â  	function setupLightboxListeners() {
Â  	  document.querySelectorAll('.photo img').forEach(img => {
Â  	    img.addEventListener('click', (e) => {
Â  	      e.stopPropagation();Â 
Â  	      
Â  	      const photoId = e.target.getAttribute('data-id');
Â  	      const originalIndex = photos.findIndex(p => p.id === photoId);
Â  	      
Â  	      showLightboxPhoto(originalIndex);
Â  	      
Â  	      lightbox.classList.add('visible');
Â  	    });
Â  	  });

Â  	  document.querySelectorAll('.music-link-icon').forEach(icon => {
Â  	    icon.addEventListener('click', (e) => {
Â  	      e.stopPropagation();
Â  	    });
Â  	  });
Â  	}

Â  	function setupPagination(totalPages) {
Â  	  if (totalPages <= 1) return;

Â  	  const prevBtn = document.createElement('button');
Â  	  prevBtn.textContent = 'â†';
Â  	  prevBtn.className = 'nav-btn';
Â  	  prevBtn.disabled = currentPage === 1;
Â  	  prevBtn.addEventListener('click', () => {
Â  	    if (currentPage > 1) {
Â  	      currentPage--;
Â  	      renderGalleryAndPagination();
Â  	    }
Â  	  });
Â  	  paginationControls.appendChild(prevBtn);

Â  	  for (let i = 1; i <= totalPages; i++) {
Â  	    const pageBtn = document.createElement('button');
Â  	    pageBtn.textContent = i;
Â  	    pageBtn.className = 'page-btn';
Â  	    if (i === currentPage) {
Â  	      pageBtn.classList.add('active');
Â  	    }
Â  	    pageBtn.addEventListener('click', () => {
Â  	      currentPage = i;
Â  	      renderGalleryAndPagination();
Â  	    });
Â  	    paginationControls.appendChild(pageBtn);
Â  	  }

Â  	  const nextBtn = document.createElement('button');
Â  	  nextBtn.textContent = 'â†’';
Â  	  nextBtn.className = 'nav-btn';
Â  	  nextBtn.disabled = currentPage === totalPages;
Â  	  nextBtn.addEventListener('click', () => {
Â  	    if (currentPage < totalPages) {
Ind Â  	    currentPage++;
Â  	      renderGalleryAndPagination();
Â  	    }
Â  	  });
Â  	  paginationControls.appendChild(nextBtn);
Â  	}

Â  	function changePage(newPage) {
Â  	  currentPage = newPage;
Â  	  renderGalleryAndPagination();
Â  	}

Â  	enterBtn.addEventListener('click', () => {
Â  	  introScreen.classList.add('fade-out');
Â  	  
	  setTimeout(() => {
Â  	    introScreen.style.display = 'none';
Â  	    mainContent.classList.remove('hidden');
Â  	    
Â  	    loadPhotos();Â 
Â  	  }, 1000);
Â  	});

Â  	editBtn.addEventListener('click', () => {
Â  	  const senha = prompt("Digite a senha para editar:");
Â  	  if (senha === "meuamorzinho") {
Â  	    editor.classList.toggle('hidden');
Â  	    mainContent.classList.toggle('edit-mode-active');
Â  	  } else {
Â  	    alert("Senha incorreta ğŸ’”");
Â  	  }
Â  	});

Â  	addPhotoBtn.addEventListener('click', () => {
Â  	  const fileInput = document.getElementById('imageInput');
Â  	  const captionInput = document.getElementById('captionInput');
Â  	  const file = fileInput.files[0];
Â  	  const caption = captionInput.value;
Â  	  const musicLink = musicLinkInput.value;

Â  	  if (!file) {
Â  	    alert("Selecione uma imagem ğŸ’");
Â  	    return;
Â  	  }
Â  	  if (!caption) {
Â  	    alert("Adicione uma legenda! ğŸ’");
Â  	    return;
Â  	  }

Â  	  addPhotoBtn.disabled = true;
Â  	  addPhotoBtn.textContent = 'Enviando...';

Â  	  const reader = new FileReader();
Â  	  reader.onload = e => {
Â  	    resizeAndUpload(e.target.result, file.type, caption, musicLink, addPhotoBtn);
Â  	  };
Â  	  reader.readAsDataURL(file);
Â  	});

Â  	async function uploadToCloudinary(base64Image) {
Â  	  const url = `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/image/upload`;
Â  	  
Â  	  const formData = new FormData();
Â  	  formData.append('file', base64Image);
Â  	  formData.append('upload_preset', UPLOAD_PRESET);

Â  	  const response = await fetch(url, {
Â  	    method: 'POST',
Â  	    body: formData,
Â  	  });

Â  	  const data = await response.json();
Â  	  if (data.secure_url) {
Â  	    return data.secure_url;
Â  	  } else {
Â  	    throw new Error('Cloudinary upload failed: ' + (data.error ? data.error.message : 'Unknown error'));
Â  	  }
Â  	}

Â  	function resizeAndUpload(dataURL, mimeType, caption, musicLink, button) {
Â  	  const MAX_WIDTH = 1920;
Â  	  const MAX_HEIGHT = 1080;
Â  	  
Â  	  const img = new Image();
Â  	  img.src = dataURL;
Â  	  
Â  	  img.onload = async () => {
Â  	    try {
Â  	      let width = img.width;
Â  	      let height = img.height;

Â  	      if (width > height) {
Â  	        if (width > MAX_WIDTH) {
Â  	          height = height * (MAX_WIDTH / width);
Â  	          width = MAX_WIDTH;
Â  	        }
Â  	      } else {
Â  	        if (height > MAX_HEIGHT) {
Â  	          width = width * (MAX_HEIGHT / height);
Â  	          height = MAX_HEIGHT;
Â  	        }
Â  	      }
Â  	      
Â  	      const canvas = document.createElement('canvas');
Â  	      canvas.width = width;
Â  	      canvas.height = height;
Â  	      const ctx = canvas.getContext('2d');
Â  	      ctx.drawImage(img, 0, 0, width, height);
Â  	      
Â  	      const resizedBase64 = canvas.toDataURL('image/jpeg', 0.8);
Â  	      
Â  	      const downloadURL = await uploadToCloudinary(resizedBase64);

Â  	      await photosCollection.add({
Â  	        url: downloadURL,
Â  	        caption: caption,
Â  	        musicLink: musicLink,
Â  	        timestamp: firebase.firestore.FieldValue.serverTimestamp()
Â  	      });
Â  	      
Â  	      alert("Foto adicionada com sucesso! (VisÃ­vel para todos)");
Â  	      
Â  	      document.getElementById('imageInput').value = '';
Â  	      document.getElementById('captionInput').value = '';
Â  	      musicLinkInput.value = '';
Â  	      
Â  	      currentPage = 1;
Â  	      await loadPhotos();
Â  	    } catch (error) {
Â  	      console.error("Erro ao subir a foto:", error);
Â  	      alert("Erro ao enviar a foto para a nuvem. Verifique o console para detalhes.");
Â  	    } finally {
Â  	      button.disabled = false;
Â  	      button.textContent = 'Adicionar';
Â  	    }
Â  	  };
Â  	}

Â  	gallery.addEventListener('click', (e) => {
Â  	  if (e.target.classList.contains('delete-btn')) {
Â  	    if (!confirm("Tem certeza que quer apagar esta foto? Esta aÃ§Ã£o nÃ£o pode ser desfeita.")) {
Â  	      return;
Â  	    }
Â  	    const photoId = e.target.getAttribute('data-id');
Â  	    deletePhoto(photoId);
Â  	  }
Â  	});

Â  	lightboxPrevBtn.addEventListener('click', (e) => {
Â  	  e.stopPropagation();
Â  	  if (currentLightboxIndex > 0) {
Â  	    showLightboxPhoto(currentLightboxIndex - 1);
Â  	  }
Â  	});

Â  	lightboxNextBtn.addEventListener('click', (e) => {
Â  	  e.stopPropagation();
Â  	  if (currentLightboxIndex < photos.length - 1) {
Â  	    showLightboxPhoto(currentLightboxIndex + 1);
Â  	  }
Â  	});

Â  	closeLightboxBtn.addEventListener('click', () => {
Â  	  lightbox.classList.remove('visible');
Â  	});

Â  	lightbox.addEventListener('click', (e) => {
Â  	  if (e.target.id === 'lightbox') {
Â  	    lightbox.classList.remove('visible');
Â  	  }
Â  	});

Â  	changeBgBtn.addEventListener('click', async () => {
Â  	  const file = bgImageInput.files[0];
Â  	  if (!file) {
Â  	    alert("Selecione uma imagem de fundo.");
Â  	    return;
Â  	  }

Â  	  changeBgBtn.disabled = true;
Â  	  changeBgBtn.textContent = 'Enviando...';

Â  	  const reader = new FileReader();
Â  	  reader.onload = async e => {
Â  	    try {
Â  	      const MAX_BG_WIDTH = 1920;
Â  	      const resizedUrl = await new Promise(resolve => {
Â  	        const img = new Image();
Â  	        img.onload = async () => {
Â  	          const canvas = document.createElement('canvas');
Â  	          let width = img.width;
Â  	          let height = img.height;
Â  	          if (width > MAX_BG_WIDTH) {
Â  	            height = height * (MAX_BG_WIDTH / width);
Â  	            width = MAX_BG_WIDTH;
Â  	          }
Â  	          canvas.width = width;
Â  	          canvas.height = height;
Â  	          canvas.getContext('2d').drawImage(img, 0, 0, width, height);
Â  	          
Â  	          const base64Image = canvas.toDataURL('image/jpeg', 0.6);
Â  	          const downloadURL = await uploadToCloudinary(base64Image);
Â  	          resolve(downloadURL);
Â  	        };
Â  	        img.src = e.target.result;
Â  	      });

Â  	      await settingsDoc.set({ backgroundImageUrl: resizedUrl }, { merge: true });
Â  	      
Â  	      applyBackground(resizedUrl);
Â  	      alert("Fundo alterado com sucesso! VisÃ­vel para todos.");
Â  	      bgImageInput.value = '';
Â  	    } catch (error) {
Â  	      console.error("Erro ao alterar fundo:", error);
Â  	      alert("Erro ao alterar fundo.");
Â  	    } finally {
Â  	      changeBgBtn.disabled = false;
Â  	      changeBgBtn.textContent = 'Salvar Fundo';
Â  	    }
Â  	  };
Â  	  reader.readAsDataURL(file);
Â  	});

Â  	removeBgBtn.addEventListener('click', () => {
Â  	  if (confirm("Tem certeza que quer remover o fundo personalizado?")) {
ind Â  	    removeBackground();
Â  	  }
Â  	});

Â  	document.addEventListener('DOMContentLoaded', () => {
Â  	  loadSettings();Â 
Â  	});
Â  	
Â  	let isDragging = false;
Â  	let startX, startY, startLeft, startTop;

Â  	function startDrag(e) {
Â  	  isDragging = true;
Â  	  const event = e.touches ? e.touches[0] : e;
Â  	  
Â  	  startX = event.clientX;
Â  	  startY = event.clientY;

Â  	  const rect = spotifyPlayer.getBoundingClientRect();
Â  	  startLeft = rect.left;
Â  	  startTop = rect.top;

Â  	  spotifyPlayer.style.right = 'auto';
Â  	  spotifyPlayer.style.bottom = 'auto';
Â  	  spotifyPlayer.style.left = startLeft + 'px';
Â  	  spotifyPlayer.style.top = startTop + 'px';

Â  	  spotifyPlayer.style.pointerEvents = 'none';
Â  	  document.body.style.userSelect = 'none';
Â  	}

Â  	function doDrag(e) {
Â  	  if (!isDragging) return;
Â  	  if (e.touches) e.preventDefault();
Â  	  const event = e.touches ? e.touches[0] : e;
Â  	  
Â  	  let deltaX = event.clientX - startX;
Â  	  let deltaY = event.clientY - startY;

Â  	  spotifyPlayer.style.left = (startLeft + deltaX) + 'px';
Â  	  spotifyPlayer.style.top = (startTop + deltaY) + 'px';
Â  	}

Â  	function stopDrag() {
Â  	  if (!isDragging) return;
Â  	  isDragging = false;
Â  	  spotifyPlayer.style.pointerEvents = 'auto';
Â  	  document.body.style.userSelect = 'auto';
Â  	}

Â  	spotifyPlayer.addEventListener('mousedown', startDrag);
Â  	document.addEventListener('mousemove', doDrag);
Â  	document.addEventListener('mouseup', stopDrag);

Â  	spotifyPlayer.addEventListener('touchstart', startDrag);
Â  	document.addEventListener('touchmove', doDrag, { passive: false }); 
Â  	document.addEventListener('touchend', stopDrag);
Â  	document.addEventListener('touchcancel', stopDrag);
Â  </script>
</body>
</html>
